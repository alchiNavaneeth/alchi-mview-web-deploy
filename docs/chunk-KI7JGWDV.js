import{Ab as L,Wc as a,da as v,ea as O,ga as w,ia as P}from"./chunk-PDC2UTBK.js";import{a as d}from"./chunk-EQDQRRRY.js";var g=class n{constructor(e){this.startScrollPosition=0,this.interruptListenersAttached=!1,this.timer=null,!e.scrollViews||e.scrollViews.length===0?(e.scrollViews=[e.document.documentElement,e.document.body,e.document.body.parentNode],this.isInlineScrolling=!1):this.isInlineScrolling=!0,this.pageScrollOptions=e}static getScrollingTargetPosition(e,t){let i=e.document.body,o=e.document.documentElement,s=e.document.defaultView&&e.document.defaultView.pageYOffset||void 0,u=e.document.defaultView&&e.document.defaultView.pageXOffset||void 0,l=s||o.scrollTop||i.scrollTop,p=u||o.scrollLeft||i.scrollLeft,r=o.clientTop||i.clientTop||0,f=o.clientLeft||i.clientLeft||0;if(t==null)return{top:l,left:p};let c=t.getBoundingClientRect(),h=c.top+l-r,S=c.left+p-f;return{top:Math.round(h),left:Math.round(S)}}static getInlineScrollingTargetPosition(e,t){let i={top:t.offsetTop,left:t.offsetLeft};if(e.advancedInlineOffsetCalculation&&e.scrollViews.length===1){let o={top:0,left:0},s=t.ownerDocument.defaultView,u=!1,l=t.parentElement;for(;!u&&l!==void 0&&l!==null;)s.getComputedStyle(l).getPropertyValue("position")==="relative"&&(o.top+=l.offsetTop,o.left+=l.offsetLeft),l=l.parentElement,u=l===e.scrollViews[0];u&&(i.top+=o.top,i.left+=o.left)}return i}getScrollPropertyValue(e){return this.pageScrollOptions.verticalScrolling?e.scrollTop:e.scrollLeft}getScrollClientPropertyValue(e){return this.pageScrollOptions.verticalScrolling?e.clientHeight:e.clientWidth}extractScrollTargetPosition(){let e=this.getScrollTargetElement();return e==null?{top:NaN,left:NaN}:this.isInlineScrolling?n.getInlineScrollingTargetPosition(this.pageScrollOptions,e):n.getScrollingTargetPosition(this.pageScrollOptions,e)}getCurrentOffset(){return this.pageScrollOptions.scrollOffset}setScrollPosition(e){return this.pageScrollOptions.scrollViews.reduce((t,i)=>{let o=this.getScrollPropertyValue(i);if(i&&o!==void 0&&o!==null){let s=Math.abs(o-e),u=s<this.pageScrollOptions._minScrollDistance;if(this.pageScrollOptions.verticalScrolling?i.scrollTop=e:i.scrollLeft=e,u||s>Math.abs(this.getScrollPropertyValue(i)-e))return!0}return t},!1)}fireEvent(e){this.pageScrollOptions.scrollFinishListener&&this.pageScrollOptions.scrollFinishListener.emit(e)}attachInterruptListeners(e){this.interruptListenersAttached&&this.detachInterruptListeners(),this.interruptListener=t=>{e.report(t,this)},this.pageScrollOptions.interruptEvents.forEach(t=>this.pageScrollOptions.document.body.addEventListener(t,this.interruptListener)),this.interruptListenersAttached=!0}detachInterruptListeners(){this.pageScrollOptions.interruptEvents.forEach(e=>this.pageScrollOptions.document.body.removeEventListener(e,this.interruptListener)),this.interruptListenersAttached=!1}getScrollTargetElement(){if(typeof this.pageScrollOptions.scrollTarget=="string"){let e=this.pageScrollOptions.scrollTarget;return e.match(/^#[^\s]+$/g)!==null?this.pageScrollOptions.document.getElementById(e.substr(1)):this.pageScrollOptions.document.querySelector(e)}return this.pageScrollOptions.scrollTarget}},m=new w("ngxps_config"),T={_interval:10,_minScrollDistance:2,_logLevel:1,namespace:"default",verticalScrolling:!0,duration:1250,scrollOffset:0,advancedInlineOffsetCalculation:!1,interruptEvents:["mousedown","wheel","DOMMouseScroll","mousewheel","keyup","touchmove"],interruptKeys:[" ","Escape","Tab","Enter","PageUp","PageDown","Home","End","ArrowUp","ArrowRight","ArrowLeft","ArrowDown"],interruptible:!0,scrollInView:!0,easingLogic:(n,e,t,i)=>t*n/i+e},y=(()=>{class n{stopInternal(t,i){let o=this.runningInstances.indexOf(i);return o>=0&&this.runningInstances.splice(o,1),i.interruptListenersAttached&&i.detachInterruptListeners(),i.timer?(clearInterval(i.timer),i.timer=void 0,i.fireEvent(!t),!0):!1}create(t){return new g(d(d({},this.config),t))}start(t){if(t.pageScrollOptions=d(d({},this.config),t.pageScrollOptions),this.stopAll(t.pageScrollOptions.namespace),t.pageScrollOptions.scrollViews===null||t.pageScrollOptions.scrollViews.length===0){(this.config._logLevel>=2||this.config._logLevel>=1&&a())&&console.warn("No scrollViews specified, thus ngx-page-scroll does not know which DOM elements to scroll");return}let i=!1,o=t.getScrollClientPropertyValue(t.pageScrollOptions.scrollViews[0]);t.startScrollPosition=0,t.pageScrollOptions.scrollViews.forEach(r=>{if(r==null)return;let f=t.getScrollPropertyValue(r);!i&&f&&(t.startScrollPosition=f,i=!0,o=t.getScrollClientPropertyValue(r))});let s=t.getCurrentOffset(),u=t.extractScrollTargetPosition();if(t.targetScrollPosition=Math.round((t.pageScrollOptions.verticalScrolling?u.top:u.left)-s),t.distanceToScroll=t.targetScrollPosition-t.startScrollPosition,isNaN(t.distanceToScroll)){(this.config._logLevel>=2||this.config._logLevel>=1&&a())&&console.log("Scrolling not possible, as we can't find the specified target"),t.fireEvent(!1);return}let l=Math.abs(t.distanceToScroll)<t.pageScrollOptions._minScrollDistance;t.executionDuration=t.pageScrollOptions.duration,t.pageScrollOptions.speed!==void 0&&t.pageScrollOptions.speed!==null&&(t.pageScrollOptions.duration===void 0||t.pageScrollOptions.duration===null)&&(t.executionDuration=Math.abs(t.distanceToScroll)/t.pageScrollOptions.speed*1e3);let p=t.executionDuration<=t.pageScrollOptions._interval;if(l||p){(this.config._logLevel>=2||this.config._logLevel>=1&&a())&&console.log(l?"Scrolling not possible, as we can't get any closer to the destination":"Scroll duration shorter that interval length, jumping to target"),t.setScrollPosition(t.targetScrollPosition),t.fireEvent(!0);return}if(!t.pageScrollOptions.scrollInView&&t.targetScrollPosition>t.startScrollPosition&&t.targetScrollPosition<=t.startScrollPosition+o){(this.config._logLevel>=2||this.config._logLevel>=1&&a())&&console.log("Not scrolling, as target already in view"),t.fireEvent(!0);return}t.pageScrollOptions.interruptible&&t.attachInterruptListeners(this.onInterrupted),t.startTime=new Date().getTime(),t.endTime=t.startTime+t.executionDuration,t.timer=setInterval(r=>{let f=new Date().getTime(),c,h=!1;r.endTime<=f?(c=r.targetScrollPosition,h=!0):c=Math.round(r.pageScrollOptions.easingLogic(f-r.startTime,r.startScrollPosition,r.distanceToScroll,r.executionDuration)),this.config._logLevel>=5&&a()&&console.warn("Scroll Position: "+c),r.setScrollPosition(c)||(h=!0),h&&this.stopInternal(!1,r)},this.config._interval,t),this.runningInstances.push(t)}scroll(t){this.start(this.create(t))}stopAll(t){if(this.runningInstances.length>0){let i=!1;for(let o=0;o<this.runningInstances.length;++o){let s=this.runningInstances[o];(!t||s.pageScrollOptions.namespace===t)&&(i=!0,this.stopInternal(!0,s),o--)}return i}return!1}stop(t){return this.stopInternal(!0,t)}constructor(t){this.runningInstances=[],this.onInterrupted={report:(i,o)=>{if(!o.pageScrollOptions.interruptible)return;let s=!0;i.type==="keyup"?this.config.interruptKeys.indexOf(i.key)===-1&&(s=!1):i.type==="mousedown"&&(o.pageScrollOptions.scrollViews.some(u=>u.contains(i.target))||(s=!1)),s&&this.stopAll(o.pageScrollOptions.namespace)}},this.config=d(d({},T),t)}static{this.\u0275fac=function(i){return new(i||n)(P(m))}}static{this.\u0275prov=v({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})(),x=(()=>{class n{static forRoot(t){return{ngModule:n,providers:[y,{provide:m,useValue:t}]}}static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275mod=L({type:n})}static{this.\u0275inj=O({providers:[y,{provide:m,useValue:{}}]})}}return n})();export{y as a,x as b};
